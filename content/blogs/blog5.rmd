---
categories:
- ""
- ""
date: "2017-10-31T22:42:51-05:00"
description: Ananlysis of IMBD rating
draft: false
#image: pic07.jpg
keywords: ""
slug: blog5
title: IMBD
---

```{r, setup, echo=FALSE}

knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```


```{r load-libraries, echo=FALSE}

 # Load ggplot2, dplyr, and all the other tidyverse packages
library(tidyverse) 
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
library(tidyquant)

```

We will explore whether the mean IMDB rating for Steven Spielberg and Tim Burton are the same or not. 

> Before anything, write down the null and alternative hypotheses, as well as the resulting test statistic and the associated t-stat or p-value. 
>
H0: Mean IMDB rating for Steven Spielberg and Tim Burton are NOT significantly different.
H1: Mean IMDB rating for Steven Spielberg and Tim Burton are significantly different.

*Here we examine the data set*

```{r load-movies-data}
movies <- read_csv(here::here("data", "movies.csv"))
glimpse(movies)

#We skim for missing values
skim(movies)
```


## Ratings on Steven Spielberg's Films


```{r}
#creating the new data set
CI_steve <- movies %>%
  filter(director=="Steven Spielberg") %>% 
  summarise(mean_rating = mean(rating),
            sd_rating = sd(rating),
            count = n(),
            se_rating = sd_rating/sqrt(count),
            t_critical = qt(0.975, count-1), 
            margin_of_error = t_critical * se_rating,
            lower = mean_rating - t_critical * se_rating,
            upper = mean_rating + t_critical * se_rating
            )%>% 
 add_column(name="Steven Spielberg")

#t.test to get CI Steve
steve_ratings <- movies %>%
  filter(director=="Steven Spielberg") %>% 
  select(rating,director)

t.test(steve_ratings$rating, data=steve_ratings)

```


## Ratings on Tim Burton's Films


```{r}
#creating the new data set
CI_tim <- movies %>%
  filter(director=="Tim Burton") %>% 
  summarise(mean_rating = mean(rating),
            sd_rating = sd(rating),
            count = n(),
            se_rating = sd_rating/sqrt(count),
            t_critical = qt(0.975, count-1), 
            margin_of_error = t_critical * se_rating,
            lower = mean_rating - t_critical * se_rating,
            upper = mean_rating + t_critical * se_rating
            ) %>% 
 add_column(name="Tim Burton")

#t.test to get CI Tim
tim_ratings <- movies %>%
  filter(director=="Tim Burton") %>% 
  select(rating,director)

t.test(tim_ratings$rating, data=tim_ratings)

```

##Visualization of confidence intervals for both directors


```{r,fig.width=9,fig.height=5.5}

#Join the two datasets regarding CI on both directors.

comp_rating <- full_join(CI_steve,CI_tim)

comp_rating

#Visualize the CIs using ggplot. 
comp_rating %>%
  ggplot(aes(x=mean_rating,
             y=reorder(name,mean_rating))) +
  geom_point(color=c("#FA766D","#06BFC4"),
             size=4) +
  geom_errorbar(aes(xmin=lower,xmax=upper),
                width=0.07,
                color=c("#FA766D","#06BFC4"),
                size=1.5) +
  
  #We add the grey area to show the overlap.
  geom_rect(mapping=aes(xmin = 7.27, xmax = 7.33, ymin = -Inf, ymax = Inf),
            fill="#C8C8C8",
            alpha=0.4) +
  
  #We add the labels
  geom_text(aes(label=round(lower,2)), 
            vjust=-1.5,
            hjust=3,
            angle=0, 
            color="black", 
            size=4) +
  geom_text(aes(label=round(upper,2)), 
            vjust=-1.5,
            hjust=-2,
            angle=0, 
            color="black", 
            size=4) +
  geom_text(aes(label=round(mean_rating,2)), 
            vjust=-2,
            colour= "black", 
            size= 5) +
  
  #We add the theme and titles.
  theme_minimal()+
  labs(title="Spielberg's & Burton's confidence intervals overlap",
       subtitle = "95% confidence interval overlap",
       x= "IMDB Rating scale", 
       y="") + 
  
  #We add a frame around the ggplot.
   theme(panel.background = element_rect(colour = "black", size=1))
  
```

